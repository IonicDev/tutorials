<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.18" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="Description" content="Client SDK Version 2.0.0: Ionic Security client SDK for C# users" />
<meta name="keywords" content="AgentKeyServices" />
<meta name="keywords" content="ErrorCode" />
<meta name="keywords" content="ErrorCode.h" />
<meta name="keywords" content="IonicSecurity.SDK.AgentKey" />
<meta name="keywords" content="IonicSecurity.SDK.AttributesDictionary" />
<meta name="keywords" content="IonicSecurity.SDK.ChunkCipherAuto" />
<meta name="keywords" content="IonicSecurity.SDK.CreateKeysRequest" />
<meta name="keywords" content="IonicSecurity.SDK.CreateKeysResponse" />
<meta name="keywords" content="IonicSecurity.SDK.DeviceProfile" />
<meta name="keywords" content="IonicSecurity.SDK.GetKeysRequest" />
<meta name="keywords" content="IonicSecurity.SDK.GetKeysResponse" />
<meta name="keywords" content="IonicSecurity.SDK.MetadataDictionary" />
<meta name="keywords" content="IonicSecurity.SDK.SdkException" />
<meta name="keywords" content="IonicSecurity.SDK.UpdateKeysRequest" />
<meta name="keywords" content="IonicSecurity.SDK.UpdateKeysResponse" />
<title>Client SDK Version 2.0.0: AgentKeyServices Implementors Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link href="ISAgentSDK.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Client SDK Version 2.0.0
   </div>
   <div id="projectbrief">Ionic Security client SDK for C# users</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">AgentKeyServices Implementors Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#isagentkeyservices-introduction">Introduction to AgentKeyServices</a></li>
<li class="level1"><a href="#isagentkeyservices-returnvalues">Return Values</a></li>
<li class="level1"><a href="#isagentkeyservices-using">Using AgentKeyServices</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="isagentkeyservices-introduction"></a>
Introduction to AgentKeyServices</h1>
<p>AgentKeyServices is an interface that users of the SDK can use to write their own custom key services that our ciphers can use.</p>
<p><br />
</p>
<h1><a class="anchor" id="isagentkeyservices-returnvalues"></a>
Return Values</h1>
<p>All methods implemented must return AGENT_OK upon success; otherwise return an error code on failure. Please see <a class="el" href="_error_code_8h.html" title="Contains definitions for all error codes.">ErrorCode.h</a> for a list of error codes. The ciphers rely on the error codes defined in <a class="el" href="_error_code_8h.html" title="Contains definitions for all error codes.">ErrorCode.h</a> for their behavior. Please note the error codes returned in the key services functions documented in Agent, let these be your guide. <br />
<br />
Of special note is AGENT_KEY_DENIED. A getKey()/createKey() service request must return this if a key is not found/retrieved; otherwise the cipher will not know to return an access denied cover page. Again, look at the documentation for the Agent key service implementations for guidance.</p>
<p><br />
</p>
<h1><a class="anchor" id="isagentkeyservices-using"></a>
Using AgentKeyServices</h1>
<p>You can define our own key services class by implementing the interface defined in <a href="class_ionic_security_1_1_s_d_k_1_1_agent_key_services.html">AgentKeyServices</a>.</p>
<p>An example below illustrates creating a test key services class and creating a ChunkCryptoCipherAuto cipher using that service.</p>
<p>Classes used below include:<br />
</p><ul>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_agent_key.html" title="Defines a data protection key as returned by Ionic.com.">IonicSecurity.SDK.AgentKey</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_device_profile.html" title="Data class for storing device profile information (a.k.a SEP data).">IonicSecurity.SDK.DeviceProfile</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_attributes_dictionary.html" title="A Dictionary of string to List of strings (Dictionary&lt; String, List&lt; String > >).">IonicSecurity.SDK.AttributesDictionary</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_metadata_dictionary.html" title="A Dictionary of string to string (Dictionary&lt; String, String >).">IonicSecurity.SDK.MetadataDictionary</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_create_keys_request.html" title="Request container for Create Keys call.">IonicSecurity.SDK.CreateKeysRequest</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_create_keys_response.html" title="Response container for Create Keys call.">IonicSecurity.SDK.CreateKeysResponse</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_update_keys_response.html" title="Response container for Update Keys call.">IonicSecurity.SDK.UpdateKeysResponse</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_update_keys_request.html" title="Request container for Update Keys call.">IonicSecurity.SDK.UpdateKeysRequest</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_get_keys_response.html" title="Response container for Get Keys call.">IonicSecurity.SDK.GetKeysResponse</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_get_keys_request.html" title="Request container for Get Keys call.">IonicSecurity.SDK.GetKeysRequest</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_sdk_exception.html" title="An Exception class for representing SDK-specific exceptions.">IonicSecurity.SDK.SdkException</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_chunk_cipher_auto.html" title="Cipher that automatically chooses the correct cipher to use for data chunk encryption / decryption.">IonicSecurity.SDK.ChunkCipherAuto</a></li>
</ul>
<p><b>Example Custom Key Services:</b> </p><div class="fragment"><div class="line"><span class="keyword">using</span> System;</div>
<div class="line"><span class="keyword">using</span> System.IO;</div>
<div class="line"><span class="keyword">using</span> System.Linq;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> System.Runtime.Serialization;</div>
<div class="line"><span class="keyword">using</span> System.Security.Cryptography;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> IonicSecurity.SDK;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>CustomKeyServices : AgentKeyServices</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> ChunkCryptoServices_Test(<span class="keywordtype">int</span> nInitialCreatedKeys)</div>
<div class="line">    {</div>
<div class="line">        m_nNextKeyId = 1;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// set dummy device info</span></div>
<div class="line">        m_deviceProfile.DeviceId = TEST_DEVICE_ID;</div>
<div class="line">        m_deviceProfile.Server = TEST_SERVER;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// create a dummy key to set as the EI and IDC profile keys</span></div>
<div class="line">        <span class="keywordtype">byte</span>[] byDummyKey = Enumerable.Repeat((<span class="keywordtype">byte</span>)5, 32).ToArray();</div>
<div class="line"> </div>
<div class="line">        m_deviceProfile.AesCdEiProfileKeyBytes = byDummyKey;</div>
<div class="line">        m_deviceProfile.AesCdIdcProfileKeyBytes = byDummyKey;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// create initial keys, if any</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nInitialCreatedKeys; ++i)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// store the created key</span></div>
<div class="line">            m_dictCreatedKeys[m_nNextKeyId.ToString()] = <span class="keyword">new</span> AgentKey(m_nNextKeyId.ToString(), TEST_PROTECTION_KEY_ARRAY);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// increment our next key ID</span></div>
<div class="line">            m_nNextKeyId++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// pure virtual accessors</span></div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> HasActiveProfile</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">get</span> { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> DeviceProfile ActiveProfile</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">get</span> { <span class="keywordflow">return</span> m_deviceProfile; }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// pure virtual network APIs</span></div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> CreateKeysResponse CreateKeys(CreateKeysRequest agentRequest)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// throw a forced error if it is set</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_createKeysException != <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> m_createKeysException;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        CreateKeysResponse response = <span class="keyword">new</span> CreateKeysResponse();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">foreach</span> (CreateKeysRequest.Key requestKey in agentRequest.Keys)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; requestKey.Quantity; ++i)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// create new key object</span></div>
<div class="line">                CreateKeysResponse.Key responseKey = <span class="keyword">new</span> CreateKeysResponse.Key(requestKey.RefId, m_nNextKeyId.ToString(), TEST_PROTECTION_KEY_ARRAY, TEST_DEVICE_ID, TEST_KEY_ORIGIN, requestKey.Attributes, requestKey.MutableAttributes, <span class="keyword">new</span> KeyObligationsMap()<span class="comment">/*Obligations*/</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// add to output key vector</span></div>
<div class="line">                response.Keys.Add(responseKey);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// store the created key</span></div>
<div class="line">                AgentKey keyData = <span class="keyword">new</span> AgentKey(responseKey.Id, responseKey.Bytes, requestKey.Attributes, requestKey.MutableAttributes, responseKey.Obligations);</div>
<div class="line">                keyData.MutableAttributesMapFromServer = responseKey.MutableAttributes;</div>
<div class="line">                keyData.MutableAttributesSigBase64FromServer = genChecksum(responseKey.MutableAttributes);</div>
<div class="line">                keyData.AttributesSigBase64FromServer = genChecksum(responseKey.Attributes);</div>
<div class="line">                m_dictCreatedKeys[responseKey.Id] = keyData;</div>
<div class="line">                <span class="comment">// increment our next key ID</span></div>
<div class="line">                m_nNextKeyId++;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> response;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> CreateKeysResponse CreateKey(AttributesDictionary dictKeyAttributes, AttributesDictionary dictMutableKeyAttributes, MetadataDictionary dictMetadata)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// throw a forced error if it is set</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_createKeysException != <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> m_createKeysException;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// perform key create request</span></div>
<div class="line">        CreateKeysRequest keysRequest = <span class="keyword">new</span> CreateKeysRequest();</div>
<div class="line">        keysRequest.Metadata = dictMetadata;</div>
<div class="line">        keysRequest.Keys.Add(<span class="keyword">new</span> CreateKeysRequest.Key(<span class="stringliteral">"refId"</span>, 1, dictKeyAttributes, dictMutableKeyAttributes));</div>
<div class="line">        CreateKeysResponse response = CreateKeys(keysRequest);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// check to be sure we got a key back.  if not, then return a key denied error.</span></div>
<div class="line">        <span class="keywordflow">if</span> (response.Keys.Count == 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> SdkException((<span class="keywordtype">int</span>)<a class="code" href="group___error_codes.html#gadc2defd6464e814121fc84c36e43daa8">ErrorCode</a>.AGENT_KEY_DENIED);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> response;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">string</span> genChecksum(AttributesDictionary attributes)</div>
<div class="line">    {</div>
<div class="line">        DataContractSerializer serializer = <span class="keyword">new</span> DataContractSerializer(attributes.GetType());</div>
<div class="line">        <span class="keyword">using</span> (MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream())</div>
<div class="line">        {</div>
<div class="line">            serializer.WriteObject(memoryStream, attributes);</div>
<div class="line">            SHA1CryptoServiceProvider hashAlgo = <span class="keyword">new</span> SHA1CryptoServiceProvider();</div>
<div class="line">            hashAlgo.ComputeHash(memoryStream.ToArray());</div>
<div class="line">            <span class="keywordflow">return</span> Convert.ToBase64String(hashAlgo.Hash);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> UpdateKeysResponse UpdateKeys(UpdateKeysRequest agentRequest)</div>
<div class="line">    {</div>
<div class="line">        UpdateKeysResponse response = <span class="keyword">new</span> UpdateKeysResponse();</div>
<div class="line">        <span class="keywordflow">foreach</span> (UpdateKeysRequest.Key key in agentRequest.Keys)</div>
<div class="line">        {</div>
<div class="line">            GetKeysResponse getKeyResponse = this.GetKey(key.Id);</div>
<div class="line">            <span class="keywordflow">if</span> (getKeyResponse.Keys.Count == 1)</div>
<div class="line">            {</div>
<div class="line">                GetKeysResponse.Key localKey = getKeyResponse.Keys[0];</div>
<div class="line">                <span class="keywordflow">if</span> (key.MutableAttributesSigBase64FromServer != localKey.MutableAttributesSigBase64FromServer)</div>
<div class="line">                {</div>
<div class="line">                    response.Errors.Add(<span class="keyword">new</span> UpdateKeysResponse.Error(key.Id, (<span class="keywordtype">int</span>)<a class="code" href="group___error_codes.html#gadc2defd6464e814121fc84c36e43daa8">ErrorCode</a>.AGENT_STALE_KEY_ATTRIBUTES, 503, <span class="stringliteral">"The key is stale"</span>));</div>
<div class="line">                    <span class="keywordflow">return</span> response;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                UpdateKeysResponse.Key updateResponseKey = <span class="keyword">new</span> UpdateKeysResponse.Key(localKey.Id,</div>
<div class="line">                  localKey.KeyBytes, localKey.DeviceId, localKey.Attributes,</div>
<div class="line">                  key.MutableAttributes, localKey.Obligations, localKey.KeyOrigin,</div>
<div class="line">                  localKey.AttributesSigBase64FromServer, genChecksum(key.MutableAttributes));</div>
<div class="line">                response.Keys.Add(updateResponseKey);</div>
<div class="line"> </div>
<div class="line">                m_dictCreatedKeys[localKey.Id].MutableAttributes = updateResponseKey.MutableAttributes;</div>
<div class="line">                m_dictCreatedKeys[localKey.Id].MutableAttributesSigBase64FromServer = updateResponseKey.MutableAttributesSigBase64FromServer;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> response;</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> UpdateKeysResponse UpdateKey(UpdateKeysRequest.Key keyRequest, MetadataDictionary dictMetadata)</div>
<div class="line">    {</div>
<div class="line">        UpdateKeysRequest request = <span class="keyword">new</span> UpdateKeysRequest();</div>
<div class="line">        request.Metadata = dictMetadata;</div>
<div class="line">        request.addKey(keyRequest);</div>
<div class="line">        <span class="keywordflow">return</span> UpdateKeys(request);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> GetKeysResponse GetKeys(GetKeysRequest agentRequest)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// throw a forced error if it is set</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_getKeysException != <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> m_getKeysException;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        GetKeysResponse response = <span class="keyword">new</span> GetKeysResponse();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> requestKeyId <span class="keywordflow">in</span> agentRequest.KeyIds)</div>
<div class="line">        {</div>
<div class="line">            AgentKey keyData;</div>
<div class="line">            <span class="keywordflow">if</span> (m_dictCreatedKeys.TryGetValue(requestKeyId, out keyData))</div>
<div class="line">            {</div>
<div class="line">                GetKeysResponse.Key responseKey = <span class="keyword">new</span> GetKeysResponse.Key(requestKeyId, keyData.KeyBytes, TEST_DEVICE_ID, TEST_KEY_ORIGIN, keyData.Attributes, keyData.MutableAttributes, keyData.Obligations);</div>
<div class="line">                responseKey.MutableAttributesMapFromServer = keyData.MutableAttributesMapFromServer;</div>
<div class="line">                responseKey.MutableAttributesSigBase64FromServer = keyData.MutableAttributesSigBase64FromServer;</div>
<div class="line">                responseKey.AttributesSigBase64FromServer = keyData.AttributesSigBase64FromServer;</div>
<div class="line">                response.Keys.Add(responseKey);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> response;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> GetKeysResponse GetKey(<span class="keywordtype">string</span> mwsKeyId, MetadataDictionary dictMetadata)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// throw a forced error if it is set</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_getKeysException != <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> m_getKeysException;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// perform key create request</span></div>
<div class="line">        GetKeysRequest keysRequest = <span class="keyword">new</span> GetKeysRequest();</div>
<div class="line">        keysRequest.Metadata = dictMetadata;</div>
<div class="line">        keysRequest.KeyIds.Add(mwsKeyId);</div>
<div class="line">        GetKeysResponse response = GetKeys(keysRequest);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// check to be sure we got a key back.  if not, then return a key denied error.</span></div>
<div class="line">        <span class="keywordflow">if</span> (response.Keys.Count == 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> SdkException((<span class="keywordtype">int</span>)<a class="code" href="group___error_codes.html#gadc2defd6464e814121fc84c36e43daa8">ErrorCode</a>.AGENT_KEY_DENIED);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> response;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> SdkException GetKeysException</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">get</span> { <span class="keywordflow">return</span> m_getKeysException; }</div>
<div class="line">        <span class="keyword">set</span> { m_getKeysException = value; }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> SdkException CreateKeysException</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">get</span> { <span class="keywordflow">return</span> m_createKeysException; }</div>
<div class="line">        <span class="keyword">set</span> { m_createKeysException = value; }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> DeviceProfile m_deviceProfile = <span class="keyword">new</span> DeviceProfile();</div>
<div class="line">    <span class="keyword">private</span> Dictionary&lt;string, AgentKey&gt; m_dictCreatedKeys = <span class="keyword">new</span> Dictionary&lt;string, AgentKey&gt;();</div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">int</span> m_nNextKeyId;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// forced error state options</span></div>
<div class="line">    <span class="keyword">private</span> SdkException m_getKeysException = <span class="keyword">null</span>;</div>
<div class="line">    <span class="keyword">private</span> SdkException m_createKeysException = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">const</span> <span class="keywordtype">string</span> TEST_KEY_ORIGIN = <span class="stringliteral">"test key server"</span>;</div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keywordtype">string</span> TEST_DEVICE_ID = <span class="stringliteral">"111-2222-333333"</span>;</div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="keywordtype">string</span> TEST_SERVER = <span class="stringliteral">"https://test.local"</span>;</div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">byte</span>[] TEST_PROTECTION_KEY_ARRAY = <span class="keyword">new</span> <span class="keywordtype">byte</span>[] { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br />
 <b>Using our example key services class:</b> </p><div class="fragment"><div class="line"><span class="keyword">using</span> IonicSecurity.SDK;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// initialize our services with 10 keys</span></div>
<div class="line">CustomKeyServices services = <span class="keyword">new</span> CustomKeyServices(10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// initialize a cipher using our custom service</span></div>
<div class="line">ChunkCipherAuto cipher = <span class="keyword">new</span> ChunkCipherAuto(services);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="agroup___error_codes_html_gadc2defd6464e814121fc84c36e43daa8"><div class="ttname"><a href="group___error_codes.html#gadc2defd6464e814121fc84c36e43daa8">IonicSecurity::SDK::ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Enumeration that represents error codes from the C++ SDK.</div><div class="ttdef"><b>Definition:</b> ErrorCode.h:32</div></div>
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer" /><address class="footer">
<p class="small">You acknowledge your access, review and use of the documentation on this page is subject to the Ionic Security Inc. <a href="https://dev.ionic.com/use.html">Documentation Use Rights</a>.</p>
<p class="small">&copy; 2016-2020 Ionic Security Inc. All rights reserved.&#160;-&#160;
Generated on Thu Jul 2 2020 12:23:19 for Client SDK Version 2.0.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen" />
</a> 1.8.18 </p>
</address>

</body>
</html>
