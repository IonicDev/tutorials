<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.18" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="Description" content="Client SDK Version 2.0.0: Ionic Security client SDK for C# users" />
<meta name="keywords" content="Example Usage - Simple" />
<meta name="keywords" content="File Cipher Classes" />
<meta name="keywords" content="IonicSecurity::SDK::AutoFileCipher" />
<meta name="keywords" content="IonicSecurity::SDK::CmsFileCipher" />
<meta name="keywords" content="IonicSecurity::SDK::CsvFileCipher" />
<meta name="keywords" content="IonicSecurity::SDK::FileCryptoDecryptAttributes" />
<meta name="keywords" content="IonicSecurity::SDK::FileCryptoDecryptAttributes::DisablePortionMarking" />
<meta name="keywords" content="IonicSecurity::SDK::FileCryptoEncryptAttributes" />
<meta name="keywords" content="IonicSecurity::SDK::FileCryptoEncryptAttributes::EnablePortionMarking" />
<meta name="keywords" content="IonicSecurity::SDK::GenericFileCipher" />
<meta name="keywords" content="IonicSecurity::SDK::OpenXmlFileCipher" />
<meta name="keywords" content="IonicSecurity::SDK::OpenXmlFileCipher::VERSION_1_0" />
<meta name="keywords" content="IonicSecurity::SDK::OpenXmlFileCipher::VERSION_1_1" />
<meta name="keywords" content="IonicSecurity::SDK::PdfFileCipher" />
<title>Client SDK Version 2.0.0: FileCrypto Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link href="ISAgentSDK.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Client SDK Version 2.0.0
   </div>
   <div id="projectbrief">Ionic Security client SDK for C# users</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FileCrypto Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#isfilecrypto-introduction">Introduction to FileCrypto</a></li>
<li class="level1"><a href="#isfilecrypto-thread">Thread Safety</a></li>
<li class="level1"><a href="#isfilecrypto-ciphers">File Cipher Classes</a></li>
<li class="level1"><a href="#isfilecrypto-families">File Cipher Families and Versions</a></li>
<li class="level1"><a href="#ISFileCryptoCipher">Streams</a></li>
<li class="level1"><a href="#isfilecrypto-autocipher">The Automatic File Cipher</a></li>
<li class="level1"><a href="#isfilecrypto-example-simple">Example Usage - Simple</a></li>
<li class="level1"><a href="#isfilecrypto-example-advanced">Example Usage - Advanced</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="isfilecrypto-introduction"></a>
Introduction to FileCrypto</h1>
<p>The FileCrypto module supports encryption and decryption of all file types.</p>
<p><br />
</p>
<h1><a class="anchor" id="isfilecrypto-thread"></a>
Thread Safety</h1>
<p>FileCrypto is not thread-safe. All classes in the FileCrypto module are not thread-safe and should not be used as a shared resource between concurrent threads. In order to use objects in a multi-threaded environment, it is recommended to create one object per thread.</p>
<p><br />
</p>
<h1><a class="anchor" id="isfilecrypto-ciphers"></a>
File Cipher Classes</h1>
<ul>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_auto_file_cipher.html">IonicSecurity::SDK::AutoFileCipher</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_cms_file_cipher.html">IonicSecurity::SDK::CmsFileCipher</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_csv_file_cipher.html">IonicSecurity::SDK::CsvFileCipher</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_generic_file_cipher.html">IonicSecurity::SDK::GenericFileCipher</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_open_xml_file_cipher.html">IonicSecurity::SDK::OpenXmlFileCipher</a></li>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_pdf_file_cipher.html">IonicSecurity::SDK::PdfFileCipher</a></li>
</ul>
<p><br />
</p>
<h1><a class="anchor" id="isfilecrypto-families"></a>
File Cipher Families and Versions</h1>
<p>Each file cipher class (see <a class="el" href="isfilecrypto.html#isfilecrypto-ciphers">File Cipher Classes</a>) supports a single format "family" and one or more format versions. The term family is used because some ciphers support a collection of related formats. <br />
<br />
For example, <a class="el" href="class_ionic_security_1_1_s_d_k_1_1_open_xml_file_cipher.html">IonicSecurity::SDK::OpenXmlFileCipher</a> supports Microsoft Office Open XML formatted files, including Word (.docx), Excel (.xlsx), etc. This family is known as IonicSecurity::SDK::FileCipherFamily::OPENXML. <a class="el" href="class_ionic_security_1_1_s_d_k_1_1_open_xml_file_cipher.html">IonicSecurity::SDK::OpenXmlFileCipher</a> supports various Ionic format versions (e.g. <a class="el" href="class_ionic_security_1_1_s_d_k_1_1_open_xml_file_cipher.html#a3f1d41d5a5832d8e2ade7b99f1c9dfff">IonicSecurity::SDK::OpenXmlFileCipher::VERSION_1_1</a>, <a class="el" href="class_ionic_security_1_1_s_d_k_1_1_open_xml_file_cipher.html#a03413484fb3d8467cc9d3d425410fedd">IonicSecurity::SDK::OpenXmlFileCipher::VERSION_1_0</a>), and more versions may be added over time to fix security issues, reduce file size, or otherwise improve upon the older formats.</p>
<p><br />
</p>
<h1><a class="anchor" id="ISFileCryptoCipher"></a>
Streams</h1>
<p>Underneath the top level Encrypt/Decrypt functions, all the Ciphers (except CMS) now operate as streams. Because we implemented these ciphers as streams, they can encrypt as they go. They need to buffer some block size worth of data in RAM, and then can encrypt and pass that block onto the next stage - eventually to the file. Block sizes vary with the different Ciphers, but 10mb is currently the common size. Since the encryption needs the plaintext and cipher text in RAM momentarily, you should expect the maximum RAM usage during encryption / decryption to be around 20 mb (plus a little overhead). This does not vary with the file size, so very large files can be encrypted without running out of RAM. <br />
<br />
The one exception to this rule is the Office formats or OpenXml formats. These files use zip, so in some cases the stream classes need the entire file available in order to manipulate them. (The zip format places the file dictionary at the end of the file.) The portion marking feature makes this especially true, and in that case, the library needs multiple copies of the file loaded. In order to do this without blowing the RAM budget, internally it may swap from a RAM buffer to a temporary file buffer when it encounters extremely large files.</p>
<p>Like in other cases, this may leave a set of deleted temporary files behind that contained sensitive data. However, if portion marking is completely disabled, the OpenXML cipher will only use one file sized buffer (potentially creating temp files) which is at the encrypted stage (prior to embedding in the cover page). Portion marking is not used unless enabled at the encryption stage in the <a class="el" href="class_ionic_security_1_1_s_d_k_1_1_file_crypto_encrypt_attributes.html">IonicSecurity::SDK::FileCryptoEncryptAttributes</a>.</p><ul>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_file_crypto_encrypt_attributes.html#ae18602b9579f892aac3da507e75a96e4">IonicSecurity::SDK::FileCryptoEncryptAttributes::EnablePortionMarking</a></li>
</ul>
<p>On the decryption side, starting with SDK version 1.6, the cover page is marked as to whether the decrypt cipher needs to scan for portion marking, so if it was never enabled, all recent files will automatically know not to scan for it. If you have older files, but never used portion marking, we recommend you use the new flag in the <a class="el" href="class_ionic_security_1_1_s_d_k_1_1_file_crypto_decrypt_attributes.html">IonicSecurity::SDK::FileCryptoDecryptAttributes</a> which disables portion mark scanning regardless.</p><ul>
<li><a class="el" href="class_ionic_security_1_1_s_d_k_1_1_file_crypto_decrypt_attributes.html#a28ee82fb22e4c1edad4d184a18bb0851">IonicSecurity::SDK::FileCryptoDecryptAttributes::DisablePortionMarking</a></li>
</ul>
<p>If nothing else, disabling the portion mark scan will improve performance.</p>
<p><br />
<br />
NOTE on CMS Cipher: Since the CMS cipher was intended for use with e-mail, it remains a fully RAM buffered implementation. It will load the entire file into RAM. Also note, that because of this, the Auto version of GetFileInfo will no longer check for CMS at all by default. The combination of this change and the streaming changes on the other ciphers means that extremely large files will no longer cause this function to blow out RAM, take huge amounts of time, and crash.</p>
<p><br />
</p>
<h1><a class="anchor" id="isfilecrypto-autocipher"></a>
The Automatic File Cipher</h1>
<p>AutoFileCipher is a special cipher in the sense that it does not represent a format of its own, but instead it automatically chooses the correct file cipher to use (e.g. OpenXmlFileCipher, PdfFileCipher) based on the contents of the file being encrypted / decrypted. Using this cipher is recommended in most cases since it simplifies the code of the consuming application. An example can be seen here: <a class="el" href="isfilecrypto.html#isfilecrypto-example-simple">Example Usage - Simple</a>. <br />
<br />
</p><h3>Important Limitations</h3>
<p>The automatic file cipher cannot and does not detect CSV or CMS file types automatically for encryption. Only decryption of these file types are supported automatically. <br />
<br />
CSV files do not follow any standard or documented format, can contain any type of delimiter, may not contain any delimiters at all, etc. For this reason, the automatic file cipher will encrypt CSV files using the generic file cipher (FileCryptoCipherGeneric) as opposed to the specialized CSV file cipher (FileCryptoCipherCsv). When the CSV file cipher is desired, it must be used directly instead of relying on the automatic cipher. <br />
<br />
Similarly, the CMS cipher will encrypt any input as the payload (typically a MIME encoded file attachment). Only the resultant encrypted CMS message follows a documented format. Therefore, when the CMS file cipher is desired for encryption, it must be used directly instead of relying on the automatic cipher.</p>
<p><br />
</p>
<h1><a class="anchor" id="isfilecrypto-example-simple"></a>
Example Usage - Simple</h1>
<div class="fragment"><div class="line"><span class="keyword">using</span> IonicSecurity.SDK;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create an initialize an agent</span></div>
<div class="line">Agent agent = <span class="keyword">new</span> Agent();</div>
<div class="line">agent.Initialize();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// encrypt a test file and then decrypt it</span></div>
<div class="line">AutoFileCipher cipher = <span class="keyword">new</span> AutoFileCipher(agent);</div>
<div class="line">cipher.Encrypt(<span class="stringliteral">"MyTestFile.docx"</span>, <span class="stringliteral">"MyEncryptedFile.docx"</span>);</div>
<div class="line">cipher.Decrypt(<span class="stringliteral">"MyEncryptedFile.docx"</span>, <span class="stringliteral">"MyRecoveredFile.docx"</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// encrypt a file in place</span></div>
<div class="line">cipher.Encrypt(<span class="stringliteral">"MyTestFile.docx"</span>);</div>
</div><!-- fragment --><p><br />
</p>
<h1><a class="anchor" id="isfilecrypto-example-advanced"></a>
Example Usage - Advanced</h1>
<div class="fragment"><div class="line"><span class="keyword">using</span> IonicSecurity.SDK;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create an initialize an agent</span></div>
<div class="line">Agent agent = <span class="keyword">new</span> Agent();</div>
<div class="line">agent.Initialize();</div>
<div class="line"> </div>
<div class="line">AutoFileCipher cipher = <span class="keyword">new</span> AutoFileCipher(agent);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use a FileCryptoEncryptAttributes object to provide key attributes that</span></div>
<div class="line"><span class="comment">// describe some aspects of the document being encrypted</span></div>
<div class="line">FileCryptoEncryptAttributes encryptAttributes = <span class="keyword">new</span> FileCryptoEncryptAttributes()</div>
<div class="line">encryptAttributes.KeyAttributes.Add("classification", new List&lt;<span class="keywordtype">string</span>&gt;());</div>
<div class="line">encryptAttributes.KeyAttributes["classification"].Add("confidential");</div>
<div class="line">encryptAttributes.KeyAttributes["classification"].Add("email");</div>
<div class="line"> </div>
<div class="line"><span class="comment">// encrypt a test file</span></div>
<div class="line">cipher.Encrypt("MyTestFile.docx", "MyEncryptedFile.docx", ref encryptAttributes);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// decrypt the file that we just encrypted</span></div>
<div class="line">FileCryptoDecryptAttributes decryptAttributes = new FileCryptoDecryptAttributes()</div>
<div class="line">cipher.Decrypt("MyEncryptedFile.docx", "MyRecoveredFile.docx", ref decryptAttributes);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer" /><address class="footer">
<p class="small">You acknowledge your access, review and use of the documentation on this page is subject to the Ionic Security Inc. <a href="https://dev.ionic.com/use.html">Documentation Use Rights</a>.</p>
<p class="small">&copy; 2016-2020 Ionic Security Inc. All rights reserved.&#160;-&#160;
Generated on Thu Jul 2 2020 12:23:19 for Client SDK Version 2.0.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen" />
</a> 1.8.18 </p>
</address>

</body>
</html>
